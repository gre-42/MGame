[
  {
    "declare_macro": "create_tiger_tank_graphics",
    "content": [
      {"call": "renderable_instance", "arguments": {"name": "chassis$SUFFIX", "node": "car_node$NODE_SUFFIX", "resource": "Tiger$DECIMATE", "included_names": "Left|Right|Hull"}},
      {"call": "renderable_instance", "arguments": {"name": "turret$SUFFIX", "node": "turret_shift_node$NODE_SUFFIX", "resource": "Tiger$DECIMATE", "included_names": "Machine_Gun|Main_Turret|Hatch"}},
      {"call": "renderable_instance", "arguments": {"name": "main_gun$SUFFIX", "node": "main_gun_shift_node$NODE_SUFFIX", "resource": "Tiger$DECIMATE", "included_names": "Main_Gun"}},
      {"required": ["%IF_SHOW_DEBUG_WHEELS"], "call": "renderable_instance", "arguments": {"name": "wheel$SUFFIX", "node": "wheel_left_0_node$NODE_SUFFIX", "resource": "M3/M3_wheel-DECIMATE"}},
      {"required": ["%IF_SHOW_DEBUG_WHEELS"], "call": "renderable_instance", "arguments": {"name": "wheel$SUFFIX", "node": "wheel_right_0_node_visual$NODE_SUFFIX", "resource": "M3/M3_wheel-DECIMATE"}},
      {"required": ["%IF_SHOW_DEBUG_WHEELS"], "call": "renderable_instance", "arguments": {"name": "wheel$SUFFIX", "node": "wheel_left_1_node$NODE_SUFFIX", "resource": "M3/M3_wheel-DECIMATE"}},
      {"required": ["%IF_SHOW_DEBUG_WHEELS"], "call": "renderable_instance", "arguments": {"name": "wheel$SUFFIX", "node": "wheel_right_1_node_visual$NODE_SUFFIX", "resource": "M3/M3_wheel-DECIMATE"}},
      {"required": ["%IF_SHOW_DEBUG_WHEELS"], "call": "renderable_instance", "arguments": {"name": "wheel$SUFFIX", "node": "wheel_left_2_node$NODE_SUFFIX", "resource": "M3/M3_wheel-DECIMATE"}},
      {"required": ["%IF_SHOW_DEBUG_WHEELS"], "call": "renderable_instance", "arguments": {"name": "wheel$SUFFIX", "node": "wheel_right_2_node_visual$NODE_SUFFIX", "resource": "M3/M3_wheel-DECIMATE"}},
      {"required": ["%IF_SHOW_DEBUG_WHEELS"], "call": "renderable_instance", "arguments": {"name": "wheel$SUFFIX", "node": "wheel_left_3_node$NODE_SUFFIX", "resource": "M3/M3_wheel-DECIMATE"}},
      {"required": ["%IF_SHOW_DEBUG_WHEELS"], "call": "renderable_instance", "arguments": {"name": "wheel$SUFFIX", "node": "wheel_right_3_node_visual$NODE_SUFFIX", "resource": "M3/M3_wheel-DECIMATE"}},
      {"required": ["%IF_SHOW_DEBUG_WHEELS"], "call": "renderable_instance", "arguments": {"name": "wheel$SUFFIX", "node": "wheel_left_4_node$NODE_SUFFIX", "resource": "M3/M3_wheel-DECIMATE"}},
      {"required": ["%IF_SHOW_DEBUG_WHEELS"], "call": "renderable_instance", "arguments": {"name": "wheel$SUFFIX", "node": "wheel_right_4_node_visual$NODE_SUFFIX", "resource": "M3/M3_wheel-DECIMATE"}}
    ]
  },
  {
    "declare_macro": "create_tiger_tank_physics",
    "content": [
      {
        "call": "rigid_cuboid",
        "arguments": {
          "node": "car_node$SUFFIX",
          "hitboxes": "tiger_tank_hitboxes",
          "mass": "%MASS",
          "size": [3.6, 3, 8],
          "com": [0, -0.5, 1],
          "collidable_mode": "%COLLIDABLE_MODE",
          "name": "tiger_tank$SUFFIX",
          "asset_id": "tiger_tank"
        }
      },
      {"comment": {"call": "damageable", "arguments": {"node": "car_node$SUFFIX", "health": 200, "delete_node_when_health_leq_zero": true}}},
      {
        "call": "yaw_pitch_look_at_nodes",
        "arguments": {
          "yaw_node": "turret_node$SUFFIX",
          "pitch_node": "main_gun_node$SUFFIX",
          "parent_follower_rigid_body_node": "car_node$SUFFIX",
          "bullet_start_offset": 20,
          "bullet_velocity": 900,
          "bullet_feels_gravity": true,
          "gravity": 9.8,
          "dyaw_max": 0.8,
          "pitch_min": -10,
          "pitch_max": 45,
          "dpitch_max": 0.8,
          "yaw_locked_on_max": 2,
          "pitch_locked_on_max": 2,
          "velocity_error_std": "%VELOCITY_ERROR_STD",
          "yaw_error_std": "%YAW_ERROR_STD",
          "pitch_error_std": "%PITCH_ERROR_STD",
          "error_alpha": "%ERROR_ALPHA"
        }
      },
      {"call": "set_inventory_capacity", "arguments": {"inventory_node": "car_node$SUFFIX", "item_type": "tiger_tank_ammo", "capacity": 2000}},
      {"call": "add_to_inventory", "arguments": {"inventory_node": "car_node$SUFFIX", "item_type": "tiger_tank_ammo", "amount": 500}},
      {
        "call": "gun",
        "arguments": {
          "node": "main_gun_end_node$SUFFIX",
          "parent_rigid_body_node": "car_node$SUFFIX",
          "punch_angle_node": "main_gun_punch_angle_node$SUFFIX",
          "cool_down": 10,
          "bullet_renderable": "tank_bullet_renderable",
          "bullet_hitbox": "tank_bullet_hitbox",
          "bullet_explosion_resource": "large_explosion",
          "bullet_explosion_animation_time": 0.6,
          "bullet_rigid_body_flags": "none",
          "bullet_mass": 20,
          "bullet_velocity": 900,
          "bullet_lifetime": 20,
          "bullet_damage": 100,
          "bullet_size": [2.4, 2.4, 20],
          "ammo_type": "tiger_tank_ammo",
          "punch_angle_idle_std": 0.01,
          "punch_angle_shoot_std": 0.1
        }
      },
      {
        "comment": {
          "call": "visual_node_status_3rd",
          "arguments": {
            "node": "car_node$SUFFIX",
            "format": 264,
            "ttf_file": "fonts/RobotoMono-Bold.ttf",
            "offset": [0, 0.3],
            "font_height": 16,
            "line_distance": 16
          }
        }
      },
      {
        "call": "create_engine",
        "arguments": {
          "rigid_body": "car_node$SUFFIX",
          "name": "main",
          "angular_vels": [-2500, -2000, -800, 0],
          "powers": ["nan", 3.6e8, 3.6e8, 0],
          "gear_ratios": [10, 20, 40, -40, -20, -10],
          "w_clutch": 800,
          "max_dw": 2000,
          "hand_brake_pulled": "%HAND_BRAKE_PULLED",
          "audio": {
            "name": "car0",
            "p_idle": 1e7,
            "p_reference": 3.6e8,
            "mute": "%MUTE"
          }
        }
      },
      {
        "call": "create_delta_engine",
        "arguments": { "rigid_body": "car_node$SUFFIX", "name": "left" }
      },
      {
        "call": "create_delta_engine",
        "arguments": { "rigid_body": "car_node$SUFFIX", "name": "right" }
      },
      {"call": "wheel", "arguments": {"rigid_body": "car_node$SUFFIX", "node": "wheel_left_0_node$SUFFIX",  "position": [-1.8, -0.0, -2.4], "radius": 0.25, "engine": "main", "delta_engine": "left",  "brake_force": 2.5e5, "Ks": 1.67e5, "Ka": 6.7e3, "musF": [6.7e4, 1.33e5], "musC": [1.1, 0.97], "tire_id": 0}},
      {"call": "wheel", "arguments": {"rigid_body": "car_node$SUFFIX", "node": "wheel_right_0_node$SUFFIX", "position": [ 1.8, -0.0, -2.4], "radius": 0.25, "engine": "main", "delta_engine": "right", "brake_force": 2.5e5, "Ks": 1.67e5, "Ka": 6.7e3, "musF": [6.7e4, 1.33e5], "musC": [1.1, 0.97], "tire_id": 1}},
      {"call": "wheel", "arguments": {"rigid_body": "car_node$SUFFIX", "node": "wheel_left_1_node$SUFFIX",  "position": [-1.8, -0.8, -0.8], "radius": 0.25, "engine": "main", "delta_engine": "left",  "brake_force": 2.5e5, "Ks": 1.67e5, "Ka": 6.7e3, "musF": [6.7e4, 1.33e5], "musC": [1.1, 0.97], "tire_id": 2}},
      {"call": "wheel", "arguments": {"rigid_body": "car_node$SUFFIX", "node": "wheel_right_1_node$SUFFIX", "position": [ 1.8, -0.8, -0.8], "radius": 0.25, "engine": "main", "delta_engine": "right", "brake_force": 2.5e5, "Ks": 1.67e5, "Ka": 6.7e3, "musF": [6.7e4, 1.33e5], "musC": [1.1, 0.97], "tire_id": 3}},
      {"call": "wheel", "arguments": {"rigid_body": "car_node$SUFFIX", "node": "wheel_left_2_node$SUFFIX",  "position": [-1.8, -0.8,  0.8], "radius": 0.25, "engine": "main", "delta_engine": "left",  "brake_force": 2.5e5, "Ks": 3.00e5, "Ka": 6.7e3, "musF": [6.7e4, 1.33e5], "musC": [1.1, 0.97], "tire_id": 4}},
      {"call": "wheel", "arguments": {"rigid_body": "car_node$SUFFIX", "node": "wheel_right_2_node$SUFFIX", "position": [ 1.8, -0.8,  0.8], "radius": 0.25, "engine": "main", "delta_engine": "right", "brake_force": 2.5e5, "Ks": 3.00e5, "Ka": 6.7e3, "musF": [6.7e4, 1.33e5], "musC": [1.1, 0.97], "tire_id": 5}},
      {"call": "wheel", "arguments": {"rigid_body": "car_node$SUFFIX", "node": "wheel_left_3_node$SUFFIX",  "position": [-1.8, -0.8,  2.4], "radius": 0.25, "engine": "main", "delta_engine": "left",  "brake_force": 2.5e5, "Ks": 1.67e5, "Ka": 6.7e3, "musF": [6.7e4, 1.33e5], "musC": [1.1, 0.97], "tire_id": 6}},
      {"call": "wheel", "arguments": {"rigid_body": "car_node$SUFFIX", "node": "wheel_right_3_node$SUFFIX", "position": [ 1.8, -0.8,  2.4], "radius": 0.25, "engine": "main", "delta_engine": "right", "brake_force": 2.5e5, "Ks": 1.67e5, "Ka": 6.7e3, "musF": [6.7e4, 1.33e5], "musC": [1.1, 0.97], "tire_id": 7}},
      {"call": "wheel", "arguments": {"rigid_body": "car_node$SUFFIX", "node": "wheel_left_4_node$SUFFIX",  "position": [-1.8, -0.0,  4  ], "radius": 0.25, "engine": "main", "delta_engine": "left",  "brake_force": 2.5e5, "Ks": 1.67e5, "Ka": 6.7e3, "musF": [6.7e4, 1.33e5], "musC": [1.1, 0.97], "tire_id": 8}},
      {"call": "wheel", "arguments": {"rigid_body": "car_node$SUFFIX", "node": "wheel_right_4_node$SUFFIX", "position": [ 1.8, -0.0,  4  ], "radius": 0.25, "engine": "main", "delta_engine": "right", "brake_force": 2.5e5, "Ks": 1.67e5, "Ka": 6.7e3, "musF": [6.7e4, 1.33e5], "musC": [1.1, 0.97], "tire_id": 9}},
      {"call": "set_rigid_body_door_distance", "arguments": {"node": "car_node$SUFFIX", "door_distance": 3}},
      {
        "call": "create_tank_controller",
        "arguments": {
          "node": "car_node$SUFFIX",
          "left_tire_ids": [0, 2, 4, 6, 8],
          "right_tire_ids": [1, 3, 5, 7, 9],
          "delta_power": 7e8
        }
      }
    ]
  },
  {
    "declare_macro": "create_tiger_tank",
    "content": [
      {"call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "car_node$SUFFIX", "name": "wheel_left_0_node$SUFFIX",  "position": [-1.8, -0.0, -2.4]}},
      {"call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "car_node$SUFFIX", "name": "wheel_right_0_node$SUFFIX", "position": [ 1.8, -0.0, -2.4]}},
      {"call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "car_node$SUFFIX", "name": "wheel_left_1_node$SUFFIX",  "position": [-1.8, -0.8, -0.8]}},
      {"call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "car_node$SUFFIX", "name": "wheel_right_1_node$SUFFIX", "position": [ 1.8, -0.8, -0.8]}},
      {"call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "car_node$SUFFIX", "name": "wheel_left_2_node$SUFFIX",  "position": [-1.8, -0.8,  0.8]}},
      {"call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "car_node$SUFFIX", "name": "wheel_right_2_node$SUFFIX", "position": [ 1.8, -0.8,  0.8]}},
      {"call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "car_node$SUFFIX", "name": "wheel_left_3_node$SUFFIX",  "position": [-1.8, -0.8,  2.4]}},
      {"call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "car_node$SUFFIX", "name": "wheel_right_3_node$SUFFIX", "position": [ 1.8, -0.8,  2.4]}},
      {"call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "car_node$SUFFIX", "name": "wheel_left_4_node$SUFFIX",  "position": [-1.8, -0.0,  4  ]}},
      {"call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "car_node$SUFFIX", "name": "wheel_right_4_node$SUFFIX", "position": [ 1.8, -0.0,  4  ]}},
      {"required": ["%IF_SHOW_DEBUG_WHEELS", "IF_WITH_GRAPHICS"], "call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "wheel_right_0_node$SUFFIX", "name": "wheel_right_0_node_visual$SUFFIX", "rotation": [0, 180, 0]}},
      {"required": ["%IF_SHOW_DEBUG_WHEELS", "IF_WITH_GRAPHICS"], "call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "wheel_right_1_node$SUFFIX", "name": "wheel_right_1_node_visual$SUFFIX", "rotation": [0, 180, 0]}},
      {"required": ["%IF_SHOW_DEBUG_WHEELS", "IF_WITH_GRAPHICS"], "call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "wheel_right_2_node$SUFFIX", "name": "wheel_right_2_node_visual$SUFFIX", "rotation": [0, 180, 0]}},
      {"required": ["%IF_SHOW_DEBUG_WHEELS", "IF_WITH_GRAPHICS"], "call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "wheel_right_3_node$SUFFIX", "name": "wheel_right_3_node_visual$SUFFIX", "rotation": [0, 180, 0]}},
      {"required": ["%IF_SHOW_DEBUG_WHEELS", "IF_WITH_GRAPHICS"], "call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "wheel_right_4_node$SUFFIX", "name": "wheel_right_4_node_visual$SUFFIX", "rotation": [0, 180, 0]}},
      {"comment": [
        {"call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "car_node$SUFFIX", "name": "com_node$SUFFIX", "position": [0, -0.5, 1]}},
        "",
        "renderable_instance name=gizmo node=com_node$SUFFIX resource=gizmo;",
        "",
        "car_node$SUFFIX;",
        "    turret_node$SUFFIX (0 0 1, yaw_node);",
        "        turret_shift_node$SUFFIX (0 0 -1, renderable);",
        "            main_gun_node$SUFFIX (0 1.2 -0.3, pitch_node);",
        "                main_gun_shift_node$SUFFIX (0 -1.2 0.3, renderable);",
        "                main_gun_end_node$SUFFIX (0 0 -20);"]
      },
      {"call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "car_node$SUFFIX", "name": "turret_node$SUFFIX", "position": [0, 0, 1], "rotation": [0, 45, 0]}},
      {"call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "turret_node$SUFFIX", "name": "turret_shift_node$SUFFIX", "position": [0, 0, -1]}},
      {"call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "turret_shift_node$SUFFIX", "name": "main_gun_node$SUFFIX", "position": [0, 1.2, -0.3], "rotation": [30, 0, 0]}},
      {"call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "main_gun_node$SUFFIX", "name": "main_gun_punch_angle_node$SUFFIX", "position": [0, 0, 0]}},
      {"call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "main_gun_punch_angle_node$SUFFIX", "name": "main_gun_shift_node$SUFFIX", "position": [0, -1.2, 0.3]}},
      {"comment": [
        "renderable_instance name=flag-inst node=car_node$SUFFIX resource=flag",
        "renderable_instance name=car_box$SUFFIX node=car_node$SUFFIX resource=tiger_tank_hitbox",
        "collidable-mesh rigid_body-node=car_node$SUFFIX node=car_node$SUFFIX resource=tiger_tank_hitbox"]
      },
      {"call": "child_node_instance", "arguments": {"type": "dynamic", "parent": "main_gun_punch_angle_node$SUFFIX", "name": "main_gun_end_node$SUFFIX", "position": [0, 0, -20]}},
      {"required": ["%IF_WITH_GRAPHICS"], "playback": "create_tiger_tank_graphics", "arguments": {"NODE_SUFFIX": "%SUFFIX", "SUFFIX": "%SUFFIX", "DECIMATE": "%DECIMATE"}},
      {"required": ["%IF_WITH_GRAPHICS"], "playback": "create_tiger_tank_graphics", "arguments": {"NODE_SUFFIX": "%SUFFIX", "SUFFIX": "_d3$SUFFIX", "DECIMATE": "_d3"}},
      {"required": ["%IF_WITH_PHYSICS"], "playback": "create_tiger_tank_physics", "arguments": {
        "SUFFIX": "%SUFFIX",
        "MASS": 56e3,
        "COLLIDABLE_MODE": "moving",
        "HAND_BRAKE_PULLED": "%HAND_BRAKE_PULLED",
        "VELOCITY_ERROR_STD": "%VELOCITY_ERROR_STD",
        "YAW_ERROR_STD": "%YAW_ERROR_STD",
        "PITCH_ERROR_STD": "%PITCH_ERROR_STD",
        "ERROR_ALPHA": "%ERROR_ALPHA",
        "MUTE": "%MUTE"
      }}
    ]
  },
  {
    "declare_macro": "create_player_car_externals_tiger_tank",
    "content": [
      {"required": ["%IF_PC"], "playback": "create_car_key_bindings", "arguments": {
        "IF_MANUAL_DRIVE": "%IF_MANUAL_DRIVE",
        "IF_MANUAL_AIM": "%IF_MANUAL_AIM",
        "IF_HAS_GUN": true,
        "SUFFIX": "%SUFFIX",
        "PLAYER_NAME": "%PLAYER_NAME",
        "ROLE": "gunner"
      }},
      {"required": ["%IF_PC"], "playback": "create_car_cameras_tank", "arguments": {
        "SUFFIX": "%SUFFIX",
        "PLAYER_NAME": "%PLAYER_NAME"
      }},
      {"required": ["%IF_PC"], "call": "hud_image", "arguments": {
        "player": "%PLAYER_NAME",
        "gun_node": "main_gun_end_node$SUFFIX",
        "camera_node": "main_gun_camera_node$SUFFIX",
        "ypln_node": "turret_node$SUFFIX",
        "filename": "textures/hud/crosshair.png",
        "update": "once",
        "center": [0, 0],
        "size": [0.05, 0.05],
        "error_behavior": "center"}},
      {"required": ["%IF_PC"], "call": "hud_image", "arguments": {
        "player": "%PLAYER_NAME",
        "gun_node": "main_gun_end_node$SUFFIX",
        "camera_node": "follower_camera",
        "ypln_node": "turret_node$SUFFIX",
        "filename": "textures/hud/crosshair.png",
        "update": "once",
        "center": [0, 0],
        "size": [0.05, 0.05],
        "error_behavior": "hide"}},
      {"call": "player_set_aiming_gun", "arguments": {
        "player": "%PLAYER_NAME",
        "ypln_node": "turret_node$SUFFIX",
        "gun_node": "main_gun_end_node$SUFFIX"}},
      {"comment": {"exclude": ["%IF_ANDROID"], "required": ["%IF_PC"], "playback": "create_player_car_engine_rpm_meter", "arguments": {
        "PLAYER_NAME": "%PLAYER_NAME",
        "ENGINE_NAME": "left"}}},
      {
        "call": "player_set_vehicle_control_parameters",
        "arguments": {
          "player": "%PLAYER_NAME",
          "surface_power_forward": "inf",
          "surface_power_backward": "-inf",
          "max_tire_angle": "%%vehicles/tiger_tank/MAX_TIRE_ANGLE",
          "tire_angle_pid": {"pid": [1, 0, 50], "alpha": 0}
        }
      }
    ]
  },
  {
    "declare_macro": "add_attached_light_tiger_tank",
    "content": [
      {"playback": "add_attached_light_tank", "arguments": {
        "LSUFFIX": "%LSUFFIX",
        "CSUFFIX": "%CSUFFIX"}}
    ]
  }
]
