[
  {
    "call": "add_texture_atlas",
    "arguments": {
      "name": "particles0_3d",
      "width": 512,
      "height": 512,
      "layers": 13,
      "depth_interpolation": "linear",
      "color_mode": "rgba",
      "images": [
        {"source_position": [   0, 0], "size": [128, 128], "target_position": [0,   0], "target_layer":  0, "texture": "#smoke"},
        {"source_position": [ 128, 0], "size": [128, 128], "target_position": [0,   0], "target_layer":  1, "texture": "#smoke"},
        {"source_position": [ 256, 0], "size": [128, 128], "target_position": [0,   0], "target_layer":  2, "texture": "#smoke"},
        {"source_position": [ 384, 0], "size": [128, 128], "target_position": [0,   0], "target_layer":  3, "texture": "#smoke"},
        {"source_position": [ 512, 0], "size": [128, 128], "target_position": [0,   0], "target_layer":  4, "texture": "#smoke"},
        {"source_position": [ 640, 0], "size": [128, 128], "target_position": [0,   0], "target_layer":  5, "texture": "#smoke"},
        {"source_position": [ 768, 0], "size": [128, 128], "target_position": [0,   0], "target_layer":  6, "texture": "#smoke"},
        {"source_position": [ 896, 0], "size": [128, 128], "target_position": [0,   0], "target_layer":  7, "texture": "#smoke"},
        {"source_position": [1024, 0], "size": [128, 128], "target_position": [0,   0], "target_layer":  8, "texture": "#smoke"},
        {"source_position": [1152, 0], "size": [128, 128], "target_position": [0,   0], "target_layer":  9, "texture": "#smoke"},
        {"source_position": [1280, 0], "size": [128, 128], "target_position": [0,   0], "target_layer": 10, "texture": "#smoke"},
        {"source_position": [1408, 0], "size": [128, 128], "target_position": [0,   0], "target_layer": 11, "texture": "#smoke"},
        {"source_position": [1536, 0], "size": [128, 128], "target_position": [0,   0], "target_layer": 12, "texture": "#smoke"},
        {"source_position": [   0, 0], "size": [128, 128], "target_position": [128, 0], "target_layer":  0, "texture": "#particles_gravel"},
        {"source_position": [ 128, 0], "size": [128, 128], "target_position": [128, 0], "target_layer":  1, "texture": "#particles_gravel"},
        {"source_position": [ 256, 0], "size": [128, 128], "target_position": [128, 0], "target_layer":  2, "texture": "#particles_gravel"},
        {"source_position": [ 384, 0], "size": [128, 128], "target_position": [128, 0], "target_layer":  3, "texture": "#particles_gravel"},
        {"source_position": [ 512, 0], "size": [128, 128], "target_position": [128, 0], "target_layer":  4, "texture": "#particles_gravel"},
        {"source_position": [ 640, 0], "size": [128, 128], "target_position": [128, 0], "target_layer":  5, "texture": "#particles_gravel"},
        {"source_position": [ 768, 0], "size": [128, 128], "target_position": [128, 0], "target_layer":  6, "texture": "#particles_gravel"},
        {"source_position": [ 896, 0], "size": [128, 128], "target_position": [128, 0], "target_layer":  7, "texture": "#particles_gravel"},
        {"source_position": [1024, 0], "size": [128, 128], "target_position": [128, 0], "target_layer":  8, "texture": "#particles_gravel"},
        {"source_position": [1152, 0], "size": [128, 128], "target_position": [128, 0], "target_layer":  9, "texture": "#particles_gravel"},
        {"source_position": [1280, 0], "size": [128, 128], "target_position": [128, 0], "target_layer": 10, "texture": "#particles_gravel"},
        {"source_position": [1408, 0], "size": [128, 128], "target_position": [128, 0], "target_layer": 11, "texture": "#particles_gravel"},
        {"source_position": [1536, 0], "size": [128, 128], "target_position": [128, 0], "target_layer": 12, "texture": "#particles_gravel"},
        {"source_position": [   0, 0], "size": [128, 128], "target_position": [256, 0], "target_layer":  0, "texture": "#particles_dirt"},
        {"source_position": [ 128, 0], "size": [128, 128], "target_position": [256, 0], "target_layer":  1, "texture": "#particles_dirt"},
        {"source_position": [ 256, 0], "size": [128, 128], "target_position": [256, 0], "target_layer":  2, "texture": "#particles_dirt"},
        {"source_position": [ 384, 0], "size": [128, 128], "target_position": [256, 0], "target_layer":  3, "texture": "#particles_dirt"},
        {"source_position": [ 512, 0], "size": [128, 128], "target_position": [256, 0], "target_layer":  4, "texture": "#particles_dirt"},
        {"source_position": [ 640, 0], "size": [128, 128], "target_position": [256, 0], "target_layer":  5, "texture": "#particles_dirt"},
        {"source_position": [ 768, 0], "size": [128, 128], "target_position": [256, 0], "target_layer":  6, "texture": "#particles_dirt"},
        {"source_position": [ 896, 0], "size": [128, 128], "target_position": [256, 0], "target_layer":  7, "texture": "#particles_dirt"},
        {"source_position": [1024, 0], "size": [128, 128], "target_position": [256, 0], "target_layer":  8, "texture": "#particles_dirt"},
        {"source_position": [1152, 0], "size": [128, 128], "target_position": [256, 0], "target_layer":  9, "texture": "#particles_dirt"},
        {"source_position": [1280, 0], "size": [128, 128], "target_position": [256, 0], "target_layer": 10, "texture": "#particles_dirt"},
        {"source_position": [1408, 0], "size": [128, 128], "target_position": [256, 0], "target_layer": 11, "texture": "#particles_dirt"},
        {"source_position": [1536, 0], "size": [128, 128], "target_position": [256, 0], "target_layer": 12, "texture": "#particles_dirt"},
        {"source_position": [   0, 0], "size": [128, 128], "target_position": [384, 0], "target_layer":  0, "texture": "#particles_snow"},
        {"source_position": [ 128, 0], "size": [128, 128], "target_position": [384, 0], "target_layer":  1, "texture": "#particles_snow"},
        {"source_position": [ 256, 0], "size": [128, 128], "target_position": [384, 0], "target_layer":  2, "texture": "#particles_snow"},
        {"source_position": [ 384, 0], "size": [128, 128], "target_position": [384, 0], "target_layer":  3, "texture": "#particles_snow"},
        {"source_position": [ 512, 0], "size": [128, 128], "target_position": [384, 0], "target_layer":  4, "texture": "#particles_snow"},
        {"source_position": [ 640, 0], "size": [128, 128], "target_position": [384, 0], "target_layer":  5, "texture": "#particles_snow"},
        {"source_position": [ 768, 0], "size": [128, 128], "target_position": [384, 0], "target_layer":  6, "texture": "#particles_snow"},
        {"source_position": [ 896, 0], "size": [128, 128], "target_position": [384, 0], "target_layer":  7, "texture": "#particles_snow"},
        {"source_position": [1024, 0], "size": [128, 128], "target_position": [384, 0], "target_layer":  8, "texture": "#particles_snow"},
        {"source_position": [1152, 0], "size": [128, 128], "target_position": [384, 0], "target_layer":  9, "texture": "#particles_snow"},
        {"source_position": [1280, 0], "size": [128, 128], "target_position": [384, 0], "target_layer": 10, "texture": "#particles_snow"},
        {"source_position": [1408, 0], "size": [128, 128], "target_position": [384, 0], "target_layer": 11, "texture": "#particles_snow"},
        {"source_position": [1536, 0], "size": [128, 128], "target_position": [384, 0], "target_layer": 12, "texture": "#particles_snow"},
        {"source_position": [   0, 0], "size": [128, 128], "target_position": [0, 128], "target_layer":  0, "texture": "#particles_dust"},
        {"source_position": [ 128, 0], "size": [128, 128], "target_position": [0, 128], "target_layer":  1, "texture": "#particles_dust"},
        {"source_position": [ 256, 0], "size": [128, 128], "target_position": [0, 128], "target_layer":  2, "texture": "#particles_dust"},
        {"source_position": [ 384, 0], "size": [128, 128], "target_position": [0, 128], "target_layer":  3, "texture": "#particles_dust"},
        {"source_position": [ 512, 0], "size": [128, 128], "target_position": [0, 128], "target_layer":  4, "texture": "#particles_dust"},
        {"source_position": [ 640, 0], "size": [128, 128], "target_position": [0, 128], "target_layer":  5, "texture": "#particles_dust"},
        {"source_position": [ 768, 0], "size": [128, 128], "target_position": [0, 128], "target_layer":  6, "texture": "#particles_dust"},
        {"source_position": [ 896, 0], "size": [128, 128], "target_position": [0, 128], "target_layer":  7, "texture": "#particles_dust"},
        {"source_position": [1024, 0], "size": [128, 128], "target_position": [0, 128], "target_layer":  8, "texture": "#particles_dust"},
        {"source_position": [1152, 0], "size": [128, 128], "target_position": [0, 128], "target_layer":  9, "texture": "#particles_dust"},
        {"source_position": [1280, 0], "size": [128, 128], "target_position": [0, 128], "target_layer": 10, "texture": "#particles_dust"},
        {"source_position": [1408, 0], "size": [128, 128], "target_position": [0, 128], "target_layer": 11, "texture": "#particles_dust"},
        {"source_position": [1536, 0], "size": [128, 128], "target_position": [0, 128], "target_layer": 12, "texture": "#particles_dust"}
      ]
    }
  },
  {
    "comment": {
      "call": "save_texture_array_png",
      "arguments": {
        "name": "particles0_3d",
        "filename_prefix": "/tmp/textures_",
        "color_mode": "rgba"
      }
    }
  },
  {
    "call": "square_resource",
    "arguments": {
      "name": "particles0_3d",
      "texture_filename": "#particles0_3d",
      "min": [-1, -1],
      "max": [1, 1],
      "occluded_pass": "none",
      "occluder_pass": "none",
      "ambient": [1, 1, 1],
      "blend_mode": "continuous",
      "alpha_distances": [0, 0, "inf", "inf"],
      "cull_faces": true,
      "aggregate_mode": "none",
      "transformation_mode": "position_lookat",
      "fog_distances": "%fog_distances",
      "fog_ambient": "%fog_ambient",
      "billboards": [
        {"uv_scale": [0.25, 0.25], "uv_offset": [0   , 0    ], "vertex_scale": [0.15, 0.15, 1], "alpha_distances": [0, 0, 250, 400], "max_center_distance": 503, "occluder_pass": "none"},
        {"uv_scale": [0.25, 0.25], "uv_offset": [0.25, 0    ], "vertex_scale": [2.5 , 2.5 , 1], "alpha_distances": [0, 0, 250, 400], "max_center_distance": 503, "occluder_pass": "none"},
        {"uv_scale": [0.25, 0.25], "uv_offset": [0.5 , 0    ], "vertex_scale": [1   , 1   , 1], "alpha_distances": [0, 0, 250, 400], "max_center_distance": 503, "occluder_pass": "none"},
        {"uv_scale": [0.25, 0.25], "uv_offset": [0.75, 0    ], "vertex_scale": [1   , 1   , 1], "alpha_distances": [0, 0, 250, 400], "max_center_distance": 503, "occluder_pass": "none"},
        {"uv_scale": [0.25, 0.25], "uv_offset": [0   , 0.25 ], "vertex_scale": [1   , 1   , 1], "alpha_distances": [0, 0, 250, 400], "max_center_distance": 503, "occluder_pass": "none"},
        {"uv_scale": [0.25, 0.25], "uv_offset": [0   , 0.25 ], "vertex_scale": [2.5 , 2.5 , 1], "alpha_distances": [0, 0, 250, 400], "max_center_distance": 503, "occluder_pass": "none"}
      ]
    }
  },
  {
    "call": "animatable_billboards",
    "arguments": {
      "name": "animatable_particles0_3d",
      "billboards": "particles0_3d",
      "max_num_instances": 10000,
      "substrate": "air"
    }
  },
  {
    "call": "animated_billboards",
    "arguments": {
      "name": "smoke_3d",
      "animatable": "animatable_particles0_3d",
      "frames": [0],
      "final_texture_w": 1,
      "duration": 0.5
    }
  },
  {
    "call": "animated_billboards",
    "arguments": {
      "name": "particles_gravel_3d",
      "animatable": "animatable_particles0_3d",
      "frames": [1],
      "final_texture_w": 1,
      "duration": 2
    }
  },
  {
    "call": "animated_billboards",
    "arguments": {
      "name": "particles_dirt_3d",
      "animatable": "animatable_particles0_3d",
      "frames": [2],
      "final_texture_w": 1,
      "duration": 0.5
    }
  },
  {
    "call": "animated_billboards",
    "arguments": {
      "name": "particles_snow_3d",
      "animatable": "animatable_particles0_3d",
      "frames": [3],
      "final_texture_w": 1,
      "duration": 0.5
    }
  },
  {
    "call": "animated_billboards",
    "arguments": {
      "name": "particles_gist_3d",
      "animatable": "animatable_particles0_3d",
      "frames": [4],
      "final_texture_w": 1,
      "duration": 0.5
    }
  },
  {
    "call": "animated_billboards",
    "arguments": {
      "name": "particles_dust_3d",
      "animatable": "animatable_particles0_3d",
      "frames": [5],
      "final_texture_w": 1,
      "duration": 2
    }
  }
]
